<!-- ржЫржмрж┐рж░ ржЗржиржкрзБржЯ -->
<label style="display:block; margin-top: 15px;">ржЫржмрж┐рж░ рж▓рж┐ржВржХрж╕ржорзВрж╣:</label>
<div id="imageInputs">
  <input type="url" name="img[]" class="img-field" placeholder="ржЫржмрж┐рж░ рж▓рж┐ржВржХ (Image URL)" required>
</div>
<button type="button" onclick="addImageField()" style="margin-top:10px;background:#444;color:#fff;padding:8px 16px;border-radius:8px;display:flex;align-items:center;gap:6px;">
  <i class="fas fa-plus"></i> ржЖрж░ржУ ржЫржмрж┐ ржжрж┐ржи (рж╕рж░рзНржмрзЛржЪрзНржЪ рзлржЯрж┐)
</button>

<!-- ржХрзЛржб ржЬрзЗржирж╛рж░рзЗрж╢ржи ржлрж╛ржВрж╢ржирзЗрж░ ржирж┐ржЪрзЗ ржпрзБржХрзНржд ржХрж░рзБржи -->
<script>
function addImageField() {
  const container = document.getElementById('imageInputs');
  const count = container.querySelectorAll('input.img-field').length;
  if (count >= 5) {
    alert("ржЖржкржирж┐ рж╕рж░рзНржмрзЛржЪрзНржЪ рзлржЯрж┐ ржЫржмрж┐ ржпрзБржХрзНржд ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред");
    return;
  }

  const input = document.createElement('input');
  input.type = "url";
  input.name = "img[]";
  input.placeholder = "ржЖрж░ржУ ржЫржмрж┐рж░ рж▓рж┐ржВржХ ржжрж┐ржи";
  input.className = "img-field";
  input.required = true;
  input.style.marginTop = "10px";

  container.appendChild(input);
}

function generateCode() {
  const name = document.getElementById("name").value;
  const code = document.getElementById("code").value;
  const price = document.getElementById("price").value;
  const offer = document.getElementById("offer").value;
  const delivery = document.getElementById("delivery").value || "N/A";
  const status = document.getElementById("status").value;
  const category = document.getElementById("category").value;
  const desc = document.getElementById("desc").value;
  const wa = document.getElementById("wa").value;

  const imgInputs = document.querySelectorAll(".img-field");
  const imgUrls = [...imgInputs].map(input => input.value.trim()).filter(url => url);

  if (!name || !code || !price || !status || !category || imgUrls.length === 0 || !wa) {
    alert("рж╕ржм ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржлрж┐рж▓рзНржб ржкрзВрж░ржг ржХрж░рзБржиред");
    return;
  }

  const finalPrice = offer
    ? `<del>рз│${price}</del> <span style="color:#f00;font-weight:bold;">рз│${offer}</span>`
    : `рз│${price}`;

  const waText = encodeURIComponent(
`ЁЯУж ржЖржорж┐ ржПржХржЯрж┐ ржкржгрзНржп ржЕрж░рзНржбрж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржЗ:
ЁЯФЦ ржкрзНрж░рзЛржбрж╛ржХрзНржЯ: ${name}
ЁЯТ░ ржорзВрж▓рзНржп: рз│${offer || price}
ЁЯз╛ ржХрзЛржб: ${code}
ЁЯУБ ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐: ${category}
ЁЯЪЪ ржбрзЗрж▓рж┐ржнрж╛рж░рж┐ ржЯрж╛ржЗржо: ${delivery}`
  );

  const waLink = `https://wa.me/${wa}?text=${waText}`;

  let slider = '';
  if (imgUrls.length === 1) {
    slider = `<div style="text-align:center;"><img src="${imgUrls[0]}" style="max-width:100%;border-radius:10px;margin-bottom:10px;" alt="${name}" /></div>`;
  } else {
    const slides = imgUrls.map((url, i) => `
      <input type="radio" name="slider" id="s${i+1}" ${i==0 ? 'checked' : ''} hidden>
    `).join('') + `
    <div class="slider">
      ${imgUrls.map((url, i) => `
        <label class="slide" for="s${(i+1)%imgUrls.length+1}" style="${i==0 ? 'opacity:1;z-index:1;' : ''}">
          <img src="${url}" alt="Product Image ${i+1}">
        </label>
      `).join('')}
    </div>
    <style>
      .slider {
        position:relative;
        width:100%;
        height:300px;
        overflow:hidden;
        border-radius:10px;
        margin-bottom:10px;
      }
      .slide {
        position:absolute;
        width:100%;
        height:100%;
        transition:opacity 0.6s ease;
        opacity:0;
      }
      .slide img {
        width:100%;
        height:100%;
        object-fit:cover;
        border-radius:10px;
      }
      input#s1:checked ~ .slider label:nth-child(1),
      input#s2:checked ~ .slider label:nth-child(2),
      input#s3:checked ~ .slider label:nth-child(3),
      input#s4:checked ~ .slider label:nth-child(4),
      input#s5:checked ~ .slider label:nth-child(5) {
        opacity:1 !important;
        z-index:1;
      }
    </style>`;
  }

  const html = `
${slider}
<h2 style="text-align:center;margin:5px 0;">${name}</h2>
<p style="text-align:center;font-size:16px;">${finalPrice}</p>
<p style="text-align:center;margin:10px 0;">
  <a href="${waLink}" target="_blank" style="display:inline-block;background:#25D366;color:#fff;padding:12px 24px;border-radius:8px;font-weight:bold;text-decoration:none;">
    ЁЯУ▓ ржЕрж░рзНржбрж╛рж░ ржХрж░рзБржи WhatsApp ржП
  </a>
</p>
<ul>
  <li>ЁЯФв ржХрзЛржб: ${code}</li>
  <li>ЁЯУж рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕: ${status}</li>
  <li>ЁЯУБ ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐: ${category}</li>
  <li>ЁЯЪЪ ржбрзЗрж▓рж┐ржнрж╛рж░рж┐ ржЯрж╛ржЗржо: ${delivery}</li>
</ul>
<p>${desc}</p>
<p style="display:none;">
  <a href="#">
    {getProduct} $button={Price} $price={рз│${offer || price}} $sale={рз│${price}} $icon={cart} $style={1}
  </a>
</p>`;

  document.getElementById("output").textContent = html;
  document.getElementById("note").textContent = "тЬЕ ржХрзЛржб рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ!";
  document.getElementById("preview").innerHTML = html;
}
</script>
