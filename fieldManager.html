<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Field Manager - G9Tool</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      background: #121212;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
    }
    header.header {
      background: #1e1e1e;
      padding: 14px 16px;
      border-radius: 0 0 15px 15px;
      display: flex;
      align-items: center;
      gap: 12px;
      height: 60px;
    }
    .back-btn {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }
    .back-btn i {
      font-size: 20px;
    }
    h1 {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
      flex-grow: 1;
      text-align: center;
    }

    main {
      max-width: 600px;
      margin: 20px auto;
      background: #1c1c1c;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }

    .field-group {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #333;
    }

    .field-group:last-child {
      border-bottom: none;
    }

    .field-label {
      font-size: 16px;
      font-weight: 500;
    }

    input[type="checkbox"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    button.save-btn {
      margin-top: 20px;
      background: #28a745;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 16px;
      width: 100%;
      transition: 0.2s ease-in-out;
    }

    button.save-btn:hover {
      opacity: 0.9;
    }

    @media (max-width: 480px) {
      header.header {
        height: 56px;
        padding: 12px;
      }
      h1 {
        font-size: 16px;
      }
      .field-label {
        font-size: 14px;
      }
      button.save-btn {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>

  <header class="header">
    <button class="back-btn" onclick="goBack()">
      <i class="fas fa-arrow-left"></i> <span onclick="goBack()">Back</span>
    </button>
    <h1>Field Manager</h1>
  </header>

  <main>
    <form id="fieldManagerForm"></form>
    <button class="save-btn" type="button" onclick="saveSettings()">Save Changes</button>
  </main>

  <script>
    const mandatoryFields = [
      { key: "name", label: "Product Name" },
      { key: "code", label: "Product Code" },
      { key: "price", label: "Price (à§³)" },
      { key: "wa", label: "WhatsApp Number" },
      { key: "images", label: "Image Link" }
    ];

    const optionalFields = [
      { key: "offer", label: "Offer Price" },
      { key: "unit", label: "Unit (e.g. pc, kg)" },
      { key: "qty", label: "Quantity (Qty)" },
      { key: "brand", label: "Brand / Company" },
      { key: "size", label: "Size Option (e.g. S, M, L)" },
      { key: "color", label: "Color Option (e.g. red, green)" },
      { key: "delivery", label: "Delivery Time" },
      { key: "status", label: "Status" },
      { key: "category", label: "Category" },
      { key: "desc", label: "Product Description" },
      { key: "video", label: "Video Link (YouTube)" },
      { key: "customFields", label: "Custom Info" }
    ];

    const form = document.getElementById("fieldManagerForm");
    const savedVisibility = JSON.parse(localStorage.getItem("fieldVisibility") || "{}");

    function renderFields() {
      form.innerHTML = "";

      mandatoryFields.forEach(field => {
        const div = document.createElement("div");
        div.className = "field-group";
        div.innerHTML = `
          <label class="field-label">${field.label} <small style="color:#0f0;">(Required)</small></label>
          <input type="checkbox" checked disabled />
        `;
        form.appendChild(div);
      });

      optionalFields.forEach(field => {
        const div = document.createElement("div");
        div.className = "field-group";

        const isChecked = savedVisibility[field.key] !== false;
        div.innerHTML = `
          <label class="field-label" for="${field.key}">${field.label}</label>
          <input type="checkbox" id="${field.key}" ${isChecked ? "checked" : ""} />
        `;
        form.appendChild(div);
      });
    }

    function saveSettings() {
      const newVisibility = {};
      optionalFields.forEach(field => {
        const checkbox = document.getElementById(field.key);
        newVisibility[field.key] = checkbox.checked;
      });
      localStorage.setItem("fieldVisibility", JSON.stringify(newVisibility));
      alert("Settings updated successfully!");
    }

    function goBack() {
      window.location.href = "dashboard.html";
    }

    function checkLogin() {
      if (!localStorage.getItem("loggedInUser")) {
        window.location.replace("index.html");
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      checkLogin();
      renderFields();
    });
  </script>

</body>
</html>
