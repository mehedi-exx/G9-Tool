<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>সংরক্ষিত ড্রাফট - G9Tool</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    .drafts-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .page-header {
      background: linear-gradient(135deg, #1e1e1e 0%, #2a2a2a 100%);
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 25px;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    
    .page-title {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }
    
    .search-bar {
      background: linear-gradient(135deg, #2a2a2a 0%, #333 100%);
      border: 2px solid #444;
      border-radius: 12px;
      padding: 12px 20px;
      width: 100%;
      max-width: 400px;
      margin: 20px auto;
      color: white;
      font-size: 16px;
    }
    
    .search-bar:focus {
      border-color: #00bfff;
      box-shadow: 0 0 20px rgba(0,191,255,0.3);
      outline: none;
    }
    
    .drafts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
      margin-top: 25px;
    }
    
    .draft-card {
      background: linear-gradient(135deg, #1c1c1c 0%, #2a2a2a 100%);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .draft-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,0,0,0.4);
      border-color: #00bfff;
    }
    
    .draft-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    
    .draft-title {
      font-size: 18px;
      font-weight: 600;
      color: #00bfff;
      margin: 0;
      line-height: 1.3;
    }
    
    .draft-date {
      font-size: 12px;
      color: #888;
      background: rgba(255,255,255,0.1);
      padding: 4px 8px;
      border-radius: 6px;
    }
    
    .draft-details {
      margin-bottom: 15px;
    }
    
    .draft-detail {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .draft-detail .label {
      color: #ccc;
      font-weight: 500;
    }
    
    .draft-detail .value {
      color: #fff;
      font-weight: 600;
    }
    
    .draft-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .action-btn {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }
    
    .edit-btn {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      color: white;
    }
    
    .edit-btn:hover {
      background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
      transform: translateY(-1px);
    }
    
    .delete-btn {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
      color: white;
    }
    
    .delete-btn:hover {
      background: linear-gradient(135deg, #c82333 0%, #a71e2a 100%);
      transform: translateY(-1px);
    }
    
    .duplicate-btn {
      background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
      color: white;
    }
    
    .duplicate-btn:hover {
      background: linear-gradient(135deg, #1e7e34 0%, #155724 100%);
      transform: translateY(-1px);
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #888;
    }
    
    .empty-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }
    
    .empty-title {
      font-size: 24px;
      margin-bottom: 10px;
      color: #ccc;
    }
    
    .empty-description {
      font-size: 16px;
      margin-bottom: 30px;
    }
    
    .create-first-btn {
      background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .create-first-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,191,255,0.4);
    }
    
    .filter-tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .filter-tab {
      background: linear-gradient(135deg, #333 0%, #555 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .filter-tab.active {
      background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(0,191,255,0.3);
    }
    
    .filter-tab:hover {
      transform: translateY(-1px);
    }
    
    @media (max-width: 768px) {
      .drafts-grid {
        grid-template-columns: 1fr;
      }
      
      .draft-actions {
        flex-direction: column;
      }
      
      .filter-tabs {
        justify-content: flex-start;
        overflow-x: auto;
        padding-bottom: 10px;
      }
      
      .filter-tab {
        white-space: nowrap;
      }
    }
  </style>
</head>
<body>

<header class="header">
  <div class="left-icons">
    <button class="menu-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
  </div>
  <div class="logo"><i class="fas fa-toolbox"></i> G9Tool Enhanced</div>
  <a class="telegram-icon" href="https://t.me/mehedi_exx" target="_blank"><i class="fab fa-telegram-plane"></i></a>
</header>

<div class="sidebar" id="sidebar">
  <button class="close-sidebar" onclick="toggleSidebar()"><i class="fas fa-times"></i></button>
  <a href="dashboard.html"><i class="fas fa-home"></i> ড্যাশবোর্ড</a>
  <a href="drafts.html" style="background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);"><i class="fas fa-save"></i> সংরক্ষিত ড্রাফট</a>
  <a href="profile.html"><i class="fas fa-user"></i> প্রোফাইল</a>
  <a href="tutorial.html"><i class="fas fa-graduation-cap"></i> টিউটোরিয়াল</a>
  <a href="admin.html"><i class="fas fa-cog"></i> এডমিন প্যানেল</a>
  <a href="fieldManager.html"><i class="fas fa-sliders-h"></i> ফিল্ড কাস্টমাইজ</a>
  <a href="file manager/Theme.html"><i class="fab fa-blogger-b"></i> ডাউনলোড থিম</a>
  <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> লগ আউট</a>
</div>

<main class="drafts-container">
  <div class="page-header">
    <h1 class="page-title"><i class="fas fa-save"></i> সংরক্ষিত ড্রাফট</h1>
    <p style="color: #ccc; margin: 0;">আপনার সংরক্ষিত প্রোডাক্ট ড্রাফটগুলি দেখুন এবং পরিচালনা করুন</p>
    <input type="text" class="search-bar" id="searchInput" placeholder="ড্রাফট খুঁজুন..." onkeyup="filterDrafts()">
  </div>

  <div class="filter-tabs">
    <button class="filter-tab active" onclick="setFilter('all')">সব ড্রাফট</button>
    <button class="filter-tab" onclick="setFilter('today')">আজকের</button>
    <button class="filter-tab" onclick="setFilter('week')">এই সপ্তাহের</button>
    <button class="filter-tab" onclick="setFilter('month')">এই মাসের</button>
  </div>

  <div id="draftsContainer">
    <!-- Drafts will be loaded here -->
  </div>
</main>

<script src="script.js"></script>
<script>
  let allDrafts = [];
  let currentFilter = 'all';

  function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("active");
  }

  function logout() {
    if (confirm("আপনি কি লগ আউট করতে চান?")) {
      localStorage.removeItem("loggedInUser");
      window.location.replace("index.html");
    }
  }

  function loadDrafts() {
    allDrafts = JSON.parse(localStorage.getItem("drafts") || "[]");
    displayDrafts(allDrafts);
  }

  function displayDrafts(drafts) {
    const container = document.getElementById("draftsContainer");
    
    if (drafts.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon"><i class="fas fa-inbox"></i></div>
          <h2 class="empty-title">কোনো ড্রাফট নেই</h2>
          <p class="empty-description">আপনার প্রথম প্রোডাক্ট তৈরি করুন এবং ড্রাফট সংরক্ষণ করুন</p>
          <a href="dashboard.html" class="create-first-btn">
            <i class="fas fa-plus"></i> প্রথম প্রোডাক্ট তৈরি করুন
          </a>
        </div>
      `;
      return;
    }

    const draftsHTML = drafts.map(draft => {
      const date = new Date(draft.timestamp);
      const formattedDate = date.toLocaleDateString('bn-BD', {
        year: 'numeric',
        month: 'short',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });

      const price = draft.offer ? `৳${draft.offer} (ছাড়: ৳${draft.price})` : `৳${draft.price}`;
      const imageCount = draft.images ? draft.images.length : 0;
      const customFieldCount = draft.customFields ? draft.customFields.length : 0;

      return `
        <div class="draft-card" data-id="${draft.id}">
          <div class="draft-header">
            <h3 class="draft-title">${draft.name || 'নামহীন প্রোডাক্ট'}</h3>
            <span class="draft-date">${formattedDate}</span>
          </div>
          
          <div class="draft-details">
            <div class="draft-detail">
              <span class="label">কোড:</span>
              <span class="value">${draft.code || 'N/A'}</span>
            </div>
            <div class="draft-detail">
              <span class="label">মূল্য:</span>
              <span class="value">${price}</span>
            </div>
            <div class="draft-detail">
              <span class="label">ক্যাটাগরি:</span>
              <span class="value">${draft.category || 'N/A'}</span>
            </div>
            <div class="draft-detail">
              <span class="label">ছবি:</span>
              <span class="value">${imageCount}টি</span>
            </div>
            <div class="draft-detail">
              <span class="label">কাস্টম ফিল্ড:</span>
              <span class="value">${customFieldCount}টি</span>
            </div>
          </div>
          
          <div class="draft-actions">
            <button class="action-btn edit-btn" onclick="editDraft(${draft.id})">
              <i class="fas fa-edit"></i> সম্পাদনা
            </button>
            <button class="action-btn duplicate-btn" onclick="duplicateDraft(${draft.id})">
              <i class="fas fa-copy"></i> কপি
            </button>
            <button class="action-btn delete-btn" onclick="deleteDraft(${draft.id})">
              <i class="fas fa-trash"></i> মুছুন
            </button>
          </div>
        </div>
      `;
    }).join('');

    container.innerHTML = `<div class="drafts-grid">${draftsHTML}</div>`;
  }

  function editDraft(id) {
    localStorage.setItem("editDraftId", id);
    window.location.href = "dashboard.html";
  }

  function duplicateDraft(id) {
    const draft = allDrafts.find(d => d.id == id);
    if (!draft) return;

    const newDraft = {
      ...draft,
      id: Date.now(),
      timestamp: new Date().toISOString(),
      name: draft.name + " (কপি)"
    };

    const drafts = JSON.parse(localStorage.getItem("drafts") || "[]");
    drafts.unshift(newDraft);
    localStorage.setItem("drafts", JSON.stringify(drafts));
    
    showToast("ড্রাফট কপি করা হয়েছে", 'success');
    loadDrafts();
  }

  function deleteDraft(id) {
    if (!confirm("আপনি কি এই ড্রাফটটি মুছে ফেলতে চান?")) return;

    let drafts = JSON.parse(localStorage.getItem("drafts") || "[]");
    drafts = drafts.filter(d => d.id != id);
    localStorage.setItem("drafts", JSON.stringify(drafts));
    
    showToast("ড্রাফট মুছে ফেলা হয়েছে", 'info');
    loadDrafts();
  }

  function setFilter(filter) {
    currentFilter = filter;
    
    // Update active tab
    document.querySelectorAll('.filter-tab').forEach(tab => {
      tab.classList.remove('active');
    });
    event.target.classList.add('active');
    
    filterDrafts();
  }

  function filterDrafts() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    let filteredDrafts = allDrafts;

    // Apply time filter
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
    const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);

    switch (currentFilter) {
      case 'today':
        filteredDrafts = filteredDrafts.filter(draft => 
          new Date(draft.timestamp) >= today
        );
        break;
      case 'week':
        filteredDrafts = filteredDrafts.filter(draft => 
          new Date(draft.timestamp) >= weekAgo
        );
        break;
      case 'month':
        filteredDrafts = filteredDrafts.filter(draft => 
          new Date(draft.timestamp) >= monthAgo
        );
        break;
    }

    // Apply search filter
    if (searchTerm) {
      filteredDrafts = filteredDrafts.filter(draft => 
        (draft.name || '').toLowerCase().includes(searchTerm) ||
        (draft.code || '').toLowerCase().includes(searchTerm) ||
        (draft.category || '').toLowerCase().includes(searchTerm) ||
        (draft.brand || '').toLowerCase().includes(searchTerm)
      );
    }

    displayDrafts(filteredDrafts);
  }

  // Enhanced toast function (if not already defined)
  function showToast(message, type = 'success') {
    const toast = document.createElement("div");
    toast.textContent = message;
    toast.className = 'toast';
    
    const colors = {
      success: 'linear-gradient(135deg, #28a745 0%, #20c997 100%)',
      error: 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)',
      info: 'linear-gradient(135deg, #007bff 0%, #0056b3 100%)',
      warning: 'linear-gradient(135deg, #ffc107 0%, #e0a800 100%)'
    };
    
    toast.style.cssText = `
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: ${colors[type] || colors.success};
      color: white;
      padding: 16px 24px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
      z-index: 9999;
      font-weight: 600;
      animation: toastSlideIn 0.3s ease-out;
    `;
    
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
  }

  // Page load
  window.addEventListener("DOMContentLoaded", () => {
    if (!localStorage.getItem("loggedInUser")) {
      window.location.replace("index.html");
      return;
    }
    
    loadDrafts();
    console.log("Drafts page loaded successfully!");
  });
</script>

</body>
</html>

