<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>G9Tool Dashboard</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>
<body>
<script>
  if (!localStorage.getItem("loggedInUser")) {
    alert("‚ö†Ô∏è ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!");
    window.location.href = "index.html";
  }
</script>

<header class="header">
  <div class="left-icons">
    <button class="menu-btn" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
    <div class="logo"><i class="fas fa-box-open"></i> G9Tool</div>
  </div>
  <a href="https://t.me/G9tool" class="telegram-icon" target="_blank"><i class="fab fa-telegram-plane"></i></a>
</header>

<main>
  <div class="form-wrapper">
    <input type="text" id="name" placeholder="‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ" required />
    <input type="text" id="code" placeholder="‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡ßã‡¶°" required />
    <input type="number" id="price" placeholder="‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶∏ (‡ß≥)" required />
    <input type="number" id="offer" placeholder="‡¶Ö‡¶´‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶∏ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)" />
    <input type="text" id="unit" placeholder="‡¶á‡¶â‡¶®‡¶ø‡¶ü (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶™‡¶ø‡¶∏, ‡¶ï‡ßá‡¶ú‡¶ø)" />
    <input type="number" id="qty" placeholder="‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (Qty)" />
    <input type="text" id="brand" placeholder="‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° / ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø" />
    <input type="text" id="size" placeholder="‡¶∏‡¶æ‡¶á‡¶ú ‡¶Ö‡¶™‡¶∂‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: S, M, L)" />
    <input type="text" id="color" placeholder="‡¶∞‡¶ô ‡¶Ö‡¶™‡¶∂‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶≤‡¶æ‡¶≤, ‡¶∏‡¶¨‡ßÅ‡¶ú)" />
    <input type="text" id="delivery" placeholder="‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶ü‡¶æ‡¶á‡¶Æ" />
    <input type="text" id="status" placeholder="‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏" />
    <input type="text" id="category" placeholder="‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø" />
    <textarea id="desc" placeholder="‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ"></textarea>

    <div id="imageInputs">
      <div class="image-group">
        <input type="url" class="img-url" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Image URL)" />
      </div>
    </div>
    <button onclick="addImageInput()"><i class="fas fa-plus"></i> ‡¶Ü‡¶∞‡¶ì ‡¶õ‡¶¨‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>

    <input type="url" id="video" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶Ç‡¶ï (YouTube)" />
    <input type="text" id="wa" placeholder="WhatsApp ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (8801XXXXXXXXXX)" required />

    <h4 style="margin-top: 20px;">üîß ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø (‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ì‡ßü‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡¶ø, ‡¶â‡ßé‡¶™‡¶æ‡¶¶‡¶® ‡¶¶‡ßá‡¶∂)</h4>
    <div id="customFields">
      <div class="custom-field-group">
        <input type="text" class="custom-key" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ ‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶ì‡ßü‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶ü‡¶ø" />
        <input type="text" class="custom-value" placeholder="‡¶Æ‡¶æ‡¶® ‡¶Ø‡ßá‡¶Æ‡¶®: ‡ß© ‡¶Æ‡¶æ‡¶∏" />
      </div>
    </div>
    <button onclick="addCustomField()"><i class="fas fa-plus"></i> ‡¶®‡¶§‡ßÅ‡¶® ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>

    <div style="text-align:center; margin-top: 15px;">
      <button id="generateBtn"><i class="fas fa-magic"></i> ‡¶ï‡ßã‡¶° ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü</button>
      <button id="copyBtn"><i class="fas fa-copy"></i> ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <button id="resetBtn" style="background:#dc3545; color:white;"><i class="fas fa-undo"></i> ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <button id="saveBtn" style="background:#28a745; color:white;"><i class="fas fa-save"></i> ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div class="output" id="output" style="white-space: pre-wrap; margin-top: 15px;"></div>
    <div class="live-preview" id="preview" style="margin-top: 20px;"></div>
  </div>
</main>

<!-- Sidebar -->
<div id="sidebar" class="sidebar">
  <button class="close-sidebar" onclick="toggleMenu()"><i class="fas fa-times"></i></button>
  <a href="dashboard.html"><i class="fas fa-home"></i> ‡¶π‡ßã‡¶Æ</a>
  <a href="menu/about.html"><i class="fas fa-info-circle"></i> ‡¶è‡¶¨‡¶æ‡¶â‡¶ü</a>
  <a href="menu/contact.html"><i class="fas fa-phone"></i> ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü</a>
  <a href="menu/privacy.html"><i class="fas fa-user-shield"></i> ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶∏‡¶ø</a>
  <a href="menu/tutorial.html"><i class="fas fa-graduation-cap"></i> ‡¶ü‡¶ø‡¶â‡¶ü‡ßã‡¶∞‡¶ø‡ßü‡¶æ‡¶≤</a>
  <a href="admin.html"><i class="fas fa-tools"></i> ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</a>
  <a href="index.html" onclick="logout()"><i class="fas fa-sign-out-alt"></i> ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</a>
</div>

<script>
let editIndex = null;
const uname = localStorage.getItem("loggedInUser");
let allData = JSON.parse(localStorage.getItem("g9tool_data") || "{}");
if (!allData[uname]) allData[uname] = [];
let userData = allData[uname];

window.onload = () => {
  const params = new URLSearchParams(window.location.search);
  if (params.has("edit")) {
    editIndex = parseInt(params.get("edit"));
    if (!isNaN(editIndex) && userData[editIndex]) loadProduct(editIndex);
  }
};

function toggleMenu() {
  document.getElementById("sidebar").classList.toggle("active");
}
function logout() {
  localStorage.removeItem("loggedInUser");
}
function addImageInput() {
  const c = document.getElementById("imageInputs");
  const div = document.createElement("div");
  div.className = "image-group";
  div.innerHTML = `<input type="url" class="img-url" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Image URL)" />`;
  c.appendChild(div);
}
function addCustomField() {
  const c = document.getElementById("customFields");
  const div = document.createElement("div");
  div.className = "custom-field-group";
  div.innerHTML = `
    <input type="text" class="custom-key" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ" />
    <input type="text" class="custom-value" placeholder="‡¶Æ‡¶æ‡¶®" />
  `;
  c.appendChild(div);
}

function getProductFromForm() {
  const val = id => document.getElementById(id).value.trim();
  const product = {
    name: val("name"),
    code: val("code"),
    price: val("price"),
    offer: val("offer"),
    unit: val("unit"),
    qty: val("qty"),
    brand: val("brand"),
    size: val("size"),
    color: val("color"),
    delivery: val("delivery"),
    status: val("status"),
    category: val("category"),
    desc: val("desc"),
    video: val("video"),
    wa: val("wa"),
    images: [...document.querySelectorAll(".img-url")].map(i => i.value.trim()).filter(v => v),
    custom: [...document.querySelectorAll(".custom-key")].map((k, i) => {
      const v = document.querySelectorAll(".custom-value")[i].value.trim();
      return k.value.trim() && v ? { key: k.value.trim(), value: v } : null;
    }).filter(Boolean)
  };
  return product;
}

function saveProduct() {
  const p = getProductFromForm();
  if (!p.name || !p.code || !p.price) return alert("‚ö†Ô∏è ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ, ‡¶ï‡ßã‡¶° ‡¶ì ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");
  if (editIndex !== null) userData[editIndex] = p;
  else userData.push(p);
  allData[uname] = userData;
  localStorage.setItem("g9tool_data", JSON.stringify(allData));
  alert("‚úÖ ‡¶∏‡ßá‡¶≠ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®!");
  clearForm();
  editIndex = null;
}

function clearForm() {
  document.querySelectorAll("input, textarea").forEach(el => el.value = "");
  document.getElementById("imageInputs").innerHTML = `<div class="image-group"><input type="url" class="img-url" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Image URL)" /></div>`;
  document.getElementById("customFields").innerHTML = `<div class="custom-field-group"><input type="text" class="custom-key" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ"><input type="text" class="custom-value" placeholder="‡¶Æ‡¶æ‡¶®"></div>`;
  document.getElementById("output").textContent = "";
  document.getElementById("preview").innerHTML = "";
}

function generateCode() {
  const p = getProductFromForm();
  if (!p.name || !p.code || !p.price) return alert("‚ö†Ô∏è ‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü ‡¶®‡¶æ‡¶Æ, ‡¶ï‡ßã‡¶° ‡¶ì ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");

  const imgs = p.images.map(url => `<img src="${url}" style="max-width:100px; margin:5px;">`).join("");
  const customs = p.custom.map(c => `<p><strong>${c.key}:</strong> ${c.value}</p>`).join("");

  const html = `
  <div class="product-card">
    <h2>${p.name}</h2>
    <p><strong>‡¶ï‡ßã‡¶°:</strong> ${p.code}</p>
    <p><strong>‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø:</strong> ‡ß≥${p.price} ${p.offer ? `(‡¶Ö‡¶´‡¶æ‡¶∞: ‡ß≥${p.offer})` : ""}</p>
    <p><strong>‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°:</strong> ${p.brand || "-"}</p>
    <p><strong>‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ:</strong> ${p.desc || "-"}</p>
    ${imgs}
    ${customs}
    ${p.video ? `<iframe width="300" height="170" src="${p.video}" frameborder="0" allowfullscreen></iframe>` : ""}
    <p><strong>WhatsApp:</strong> <a href="https://wa.me/${p.wa}" target="_blank">${p.wa}</a></p>
  </div>`;
  document.getElementById("output").textContent = html;
  document.getElementById("preview").innerHTML = html;
}

function copyOutput() {
  const txt = document.getElementById("output").textContent;
  if (!txt) return alert("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡ßã‡¶° ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®!");
  navigator.clipboard.writeText(txt).then(() => alert("‚úÖ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!"));
}

function loadProduct(i) {
  const p = userData[i];
  if (!p) return;
  const set = (id, val) => document.getElementById(id).value = val || "";
  ["name","code","price","offer","unit","qty","brand","size","color","delivery","status","category","desc","video","wa"].forEach(id => set(id, p[id]));

  const imgCtn = document.getElementById("imageInputs");
  imgCtn.innerHTML = "";
  (p.images || []).forEach(url => {
    const div = document.createElement("div");
    div.className = "image-group";
    div.innerHTML = `<input type="url" class="img-url" value="${url}" placeholder="‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Image URL)" />`;
    imgCtn.appendChild(div);
  });

  const customCtn = document.getElementById("customFields");
  customCtn.innerHTML = "";
  (p.custom || []).forEach(c => {
    const div = document.createElement("div");
    div.className = "custom-field-group";
    div.innerHTML = `<input type="text" class="custom-key" value="${c.key}" placeholder="‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ"><input type="text" class="custom-value" value="${c.value}" placeholder="‡¶Æ‡¶æ‡¶®">`;
    customCtn.appendChild(div);
  });
}

// Event bindings
document.getElementById("generateBtn").addEventListener("click", generateCode);
document.getElementById("copyBtn").addEventListener("click", copyOutput);
document.getElementById("resetBtn").addEventListener("click", clearForm);
document.getElementById("saveBtn").addEventListener("click", saveProduct);
</script>
</body>
</html>
